package my.person

import my.verifications.NonEmptyString
import my.verifications.NonBlank
import my.verifications.PhoneNumber
import my.verifications.NonEmptyList
import my.functions.isEmail

type Person {
  firstName: String verifying NonEmptyString("Please provide a first name")
  lastName: String verifying NonEmptyString("Please provide a last name")
  telephone: String
    verifying NonBlank("Please provide a phone number")
    verifying PhoneNumber
  emails: List[String]

  verify {
    "At least one email is invalid"
    (person) => {
      person.emails.forAll(isEmail)
    }
  }
}

type Identity {
  firstName: RequiredNoun
  lastName: RequiredNoun
  contacts: List[Contact]
}

type Contact {
  email: RequiredString
  phones: List[Phone]
  addresses: RequiredList[Address]
}

type Address {
  street: String
  city: String
}

type RequiredString = String verifying NonEmptyString

type RequiredNoun = String verifying NonEmptyString("This noun must be defined")

type Phone = String verifying NonBlank("Please provide a phone number") verifying PhoneNumber

type RequiredList[A] = List[A] verifying NonEmptyList